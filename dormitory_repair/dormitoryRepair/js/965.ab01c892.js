"use strict";(self["webpackChunkdormitory_repair"]=self["webpackChunkdormitory_repair"]||[]).push([[965],{2965:function(t,s,i){i.r(s),i.d(s,{default:function(){return l}});var a=function(){var t=this,s=t._self._c;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"repair-detail-container"},[s("div",{staticClass:"app-header"},[s("div",{staticClass:"header-content"},[s("div",{staticClass:"return-button",on:{click:t.back}},[s("i",{staticClass:"el-icon-arrow-left"})]),s("h1",{staticClass:"page-title"},[t._v("报修详情")])])]),s("div",{staticClass:"content-wrapper"},[s("div",{staticClass:"status-card",on:{click:t.changeButton}},[s("div",{staticClass:"status-label"},[t._v("当前状态：")]),s("div",{staticClass:"status-value",class:t.statusClass},[t._v(t._s(t.status))]),s("div",{staticClass:"status-icon"},[s("i",{class:t.statusIcon,style:{color:t.statusColor}})])]),s("div",{staticClass:"info-card"},[t._m(0),s("div",{staticClass:"info-item"},[t._m(1),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.name))])]),s("div",{staticClass:"info-item"},[t._m(2),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.phone))])]),s("div",{staticClass:"info-item"},[t._m(3),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.address))])]),s("div",{staticClass:"info-item"},[t._m(4),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.address3))])]),s("div",{staticClass:"info-item"},[t._m(5),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.start_time))])])]),s("div",{staticClass:"info-card"},[t._m(6),s("div",{staticClass:"detail-content"},[t._v(" "+t._s(t.repair_info.info)+" ")])]),s("div",{staticClass:"info-card"},[t._m(7),0===t.img_list.length?s("div",{staticClass:"empty-images"},[s("i",{staticClass:"el-icon-picture-outline empty-icon"}),s("p",[t._v("暂无图片")])]):s("div",{staticClass:"image-grid"},t._l(t.img_list,function(i,a){return s("div",{key:a,staticClass:"image-item"},[s("el-image",{staticClass:"preview-image",attrs:{src:i,"preview-src-list":t.img_list,fit:"cover"}},[s("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0)]),s("div",{staticClass:"info-card"},[t._m(8),s("div",{staticClass:"info-item"},[t._m(9),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.workerName||"待分配"))])]),s("div",{staticClass:"info-item"},[t._m(10),s("div",{staticClass:"info-content"},[t._v(t._s(t.phone))])])]),0==t.repair_info.status||3==t.repair_info.status?s("div",{staticClass:"action-button"},[s("el-button",{staticClass:"cancel-button",attrs:{type:"primary"},on:{click:t.changeButton}},[t._v(" 修改当前状态 ")])],1):t._e(),s("el-dialog",{attrs:{title:"修改状态",visible:t.dialogVisible,width:"80%","custom-class":"dialog"},on:{"update:visible":function(s){t.dialogVisible=s}}},[s("el-button",{staticClass:"changeStatusButton",attrs:{type:"warning"},on:{click:function(s){return t.changeStatus(t.repair_info.id,0)}}},[t._v("待维修")]),s("el-button",{staticClass:"changeStatusButton",attrs:{type:"success"},on:{click:function(s){return t.changeStatus(t.repair_info.id,1)}}},[t._v("已维修")]),s("el-button",{staticClass:"changeStatusButton buttonClass1",attrs:{type:"primary"},on:{click:function(s){return t.changeStatus(t.repair_info.id,3)}}},[t._v("已转服务商")])],1)],1)])},e=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-user-solid card-icon"}),s("h2",[t._v("基本信息")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-user icon"}),s("span",[t._v("报修人")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-phone icon"}),s("span",[t._v("手机号")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-location icon"}),s("span",[t._v("报修地址")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-house icon"}),s("span",[t._v("报修寝室")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-time icon"}),s("span",[t._v("报修时间")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-tickets card-icon"}),s("h2",[t._v("报修详情")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-picture card-icon"}),s("h2",[t._v("报修图片")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-s-tools card-icon"}),s("h2",[t._v("维修信息")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-user icon"}),s("span",[t._v("维修师傅")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-phone icon"}),s("span",[t._v("联系方式")])])}],n=(i(4114),{data(){return{repair_info:{},img_list:[],value1:0,status:"",loading:!0,statusColor:"",statusIcon:"",statusClass:"",phone:localStorage.getItem("dormitory_account"),dialogVisible:!1}},async mounted(){this.$route.params.id&&await this.$axios.get(`/student/getRecordById?id=${this.$route.params.id}`).then(t=>{this.repair_info=t.data.data,this.repair_info.start_time=this.repair_info.start_time.substring(0,10)+" "+this.repair_info.start_time.substring(11,19),this.repair_info.info_img&&""!==this.repair_info.info_img&&(this.img_list=this.repair_info.info_img.split(",")),this.changeStatusShow()}).finally(()=>{this.loading=!1})},methods:{changeStatusShow(){0===this.repair_info.status?(this.status="待维修",this.statusColor="#FF9800",this.statusIcon="el-icon-time",this.statusClass="status-pending"):1===this.repair_info.status?(this.status="已维修",this.statusColor="#67C23A",this.statusIcon="el-icon-circle-check",this.statusClass="status-completed"):2===this.repair_info.status?(this.status="已取消",this.statusColor="#909399",this.statusIcon="el-icon-circle-close",this.statusClass="status-cancelled"):3===this.repair_info.status&&(this.status="已转服务商",this.statusColor="#6A11CB",this.statusIcon="el-icon-refresh-right",this.statusClass="status-transferred")},changeStatus(t,s){this.$axios.post(`/student/updateStatus?id=${t}&status=${s}`).then(()=>{this.repair_info.status=s,this.changeStatusShow(),this.dialogVisible=!1,this.$message.success("状态已更新")}).catch(()=>{this.$message.error("状态更新失败")})},changeButton(){this.dialogVisible=!0},back(){this.$router.push({path:"/worker/record"})},cancel(){this.$confirm("确定要取消此报修单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"cancel-confirm"}).then(()=>{this.$axios.post(`/student/updateStatus?id=${this.repair_info.id}&status=2`).then(()=>{this.$message({message:"取消成功",type:"success",duration:1500,onClose:()=>{this.status="已取消",this.statusColor="#909399",this.statusIcon="el-icon-circle-close",this.statusClass="status-cancelled"}})})}).catch(()=>{})}}}),r=n,o=i(1656),c=(0,o.A)(r,a,e,!1,null,"b3129fa0",null),l=c.exports},4114:function(t,s,i){var a=i(6518),e=i(8981),n=i(6198),r=i(4527),o=i(6837),c=i(9039),l=c(function(){return 4294967297!==[].push.call({length:4294967296},1)}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},d=l||!u();a({target:"Array",proto:!0,arity:1,forced:d},{push:function(t){var s=e(this),i=n(s),a=arguments.length;o(i+a);for(var c=0;c<a;c++)s[i]=arguments[c],i++;return r(s,i),i}})},4376:function(t,s,i){var a=i(2195);t.exports=Array.isArray||function(t){return"Array"===a(t)}},4527:function(t,s,i){var a=i(3724),e=i(4376),n=TypeError,r=Object.getOwnPropertyDescriptor,o=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=o?function(t,s){if(e(t)&&!r(t,"length").writable)throw new n("Cannot set read only .length");return t.length=s}:function(t,s){return t.length=s}},6837:function(t){var s=TypeError,i=9007199254740991;t.exports=function(t){if(t>i)throw s("Maximum allowed index exceeded");return t}}}]);
//# sourceMappingURL=965.ab01c892.js.map