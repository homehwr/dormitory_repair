"use strict";(self["webpackChunkdormitory_repair"]=self["webpackChunkdormitory_repair"]||[]).push([[723],{1723:function(t,s,i){i.r(s),i.d(s,{default:function(){return l}});var a=function(){var t=this,s=t._self._c;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"repair-detail-container"},[s("div",{staticClass:"app-header"},[s("div",{staticClass:"header-content"},[s("div",{staticClass:"return-button",on:{click:t.back}},[s("i",{staticClass:"el-icon-arrow-left"})]),s("h1",{staticClass:"page-title"},[t._v("报修详情")])])]),s("div",{staticClass:"content-wrapper"},[s("div",{staticClass:"status-card"},[s("div",{staticClass:"status-label"},[t._v("当前状态：")]),s("div",{staticClass:"status-value",class:t.statusClass},[t._v(t._s(t.status))]),s("div",{staticClass:"status-icon"},[s("i",{class:t.statusIcon,style:{color:t.statusColor}})])]),s("div",{staticClass:"info-card"},[t._m(0),s("div",{staticClass:"info-item"},[t._m(1),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.name))])]),s("div",{staticClass:"info-item"},[t._m(2),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.phone))])]),s("div",{staticClass:"info-item"},[t._m(3),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.address))])]),s("div",{staticClass:"info-item"},[t._m(4),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.address3))])]),s("div",{staticClass:"info-item"},[t._m(5),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.start_time))])])]),s("div",{staticClass:"info-card"},[t._m(6),s("div",{staticClass:"detail-content"},[t._v(" "+t._s(t.repair_info.info)+" ")])]),s("div",{staticClass:"info-card"},[t._m(7),0===t.img_list.length?s("div",{staticClass:"empty-images"},[s("i",{staticClass:"el-icon-picture-outline empty-icon"}),s("p",[t._v("暂无图片")])]):s("div",{staticClass:"image-grid"},t._l(t.img_list,function(i,a){return s("div",{key:a,staticClass:"image-item"},[s("el-image",{staticClass:"preview-image",attrs:{src:i,"preview-src-list":t.img_list,fit:"cover"}},[s("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0)]),s("div",{staticClass:"info-card"},[t._m(8),s("div",{staticClass:"info-item"},[t._m(9),s("div",{staticClass:"info-content"},[t._v(t._s(t.repair_info.workerName||"待分配"))])]),s("div",{staticClass:"info-item"},[t._m(10),s("div",{staticClass:"info-content"},[t._v(" "+t._s(t.repair_info.workerPhone||"待分配")+" "),t.repair_info.workerPhone?s("el-button",{staticClass:"call-button",attrs:{type:"text",icon:"el-icon-phone-outline"},on:{click:function(s){return t.callWorker(t.repair_info.workerPhone)}}},[t._v(" 拨打 ")]):t._e()],1)]),s("div",{staticClass:"info-item"},[t._m(11),s("div",{staticClass:"info-content"},[s("el-rate",{attrs:{colors:["#99A9BF","#F7BA2A","#FF9900"],disabled:1!=t.repair_info.status&&3!=t.repair_info.status||t.rateDisabled},model:{value:t.value1,callback:function(s){t.value1=s},expression:"value1"}})],1)])]),0==t.repair_info.status||2==t.repair_info.status?s("div",{staticClass:"action-button"},[0==t.repair_info.status?s("el-button",{staticClass:"cancel-button",attrs:{type:"danger",icon:"el-icon-close"},on:{click:t.cancel}},[t._v(" 取消报修 ")]):t._e(),2==t.repair_info.status?s("el-button",{staticClass:"delete-button",attrs:{type:"danger",icon:"el-icon-delete"},on:{click:t.removeRecord}},[t._v(" 删除记录 ")]):t._e()],1):t._e()])])},e=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-user-solid card-icon"}),s("h2",[t._v("基本信息")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-user icon"}),s("span",[t._v("报修人")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-phone icon"}),s("span",[t._v("手机号")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-location icon"}),s("span",[t._v("报修地址")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-house icon"}),s("span",[t._v("报修寝室")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-time icon"}),s("span",[t._v("报修时间")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-tickets card-icon"}),s("h2",[t._v("报修详情")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-picture card-icon"}),s("h2",[t._v("报修图片")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-header"},[s("i",{staticClass:"el-icon-s-tools card-icon"}),s("h2",[t._v("维修信息")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-user icon"}),s("span",[t._v("维修师傅")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-phone icon"}),s("span",[t._v("联系方式")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"info-label"},[s("i",{staticClass:"el-icon-star-off icon"}),s("span",[t._v("服务评分")])])}],n=(i(4114),{data(){return{repair_info:{},img_list:[],value1:0,status:"",loading:!0,statusColor:"",statusIcon:"",statusClass:"",rateDisabled:!1}},async mounted(){this.$route.params.id&&await this.$axios.get(`/student/getRecordById?id=${this.$route.params.id}`).then(t=>{this.repair_info=t.data.data,this.repair_info.start_time=this.repair_info.start_time.substring(0,10)+" "+this.repair_info.start_time.substring(11,19),this.repair_info.info_img&&""!==this.repair_info.info_img&&(this.img_list=this.repair_info.info_img.split(",")),0===this.repair_info.status?(this.status="待维修",this.statusColor="#FF9800",this.statusIcon="el-icon-time",this.statusClass="status-pending"):1===this.repair_info.status?(this.status="已维修",this.statusColor="#67C23A",this.statusIcon="el-icon-circle-check",this.statusClass="status-completed"):2===this.repair_info.status?(this.status="已取消",this.statusColor="#909399",this.statusIcon="el-icon-circle-close",this.statusClass="status-cancelled"):3===this.repair_info.status&&(this.status="已转服务商",this.statusColor="#6A11CB",this.statusIcon="el-icon-refresh-right",this.statusClass="status-transferred"),this.repair_info.rate&&(this.value1=this.repair_info.rate,this.rateDisabled=!0)}).finally(()=>{this.loading=!1})},watch:{value1(t){t!=this.repair_info.rate&&this.$axios.post(`/record/postRate?score=${t}&id=${this.repair_info.id}`).then(t=>{200==t.data.code&&(this.$message.success("评分成功！"),this.rateDisabled=!0)})}},methods:{back(){this.$router.push({path:"/stu/record"})},cancel(){this.$confirm("确定要取消此报修单吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"cancel-confirm"}).then(()=>{this.$axios.post(`/student/updateStatus?id=${this.repair_info.id}&status=2`).then(()=>{this.$message({message:"取消成功",type:"success",duration:1500,onClose:()=>{this.status="已取消",this.statusColor="#909399",this.statusIcon="el-icon-circle-close",this.statusClass="status-cancelled",this.repair_info.status=2}})})}).catch(()=>{})},removeRecord(){this.$confirm("确定要删除此报修记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"delete-confirm"}).then(()=>{this.$axios.post(`/record/removeRecord?id=${this.repair_info.id}`).then(()=>{this.$message({message:"删除成功",type:"success",duration:1500,onClose:()=>{this.$router.push({path:"/stu/record"})}})})}).catch(()=>{})},callWorker(t){t&&window.open(`tel:${t}`)}}}),r=n,o=i(1656),c=(0,o.A)(r,a,e,!1,null,"6e28faac",null),l=c.exports},4114:function(t,s,i){var a=i(6518),e=i(8981),n=i(6198),r=i(4527),o=i(6837),c=i(9039),l=c(function(){return 4294967297!==[].push.call({length:4294967296},1)}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},d=l||!u();a({target:"Array",proto:!0,arity:1,forced:d},{push:function(t){var s=e(this),i=n(s),a=arguments.length;o(i+a);for(var c=0;c<a;c++)s[i]=arguments[c],i++;return r(s,i),i}})},4376:function(t,s,i){var a=i(2195);t.exports=Array.isArray||function(t){return"Array"===a(t)}},4527:function(t,s,i){var a=i(3724),e=i(4376),n=TypeError,r=Object.getOwnPropertyDescriptor,o=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=o?function(t,s){if(e(t)&&!r(t,"length").writable)throw new n("Cannot set read only .length");return t.length=s}:function(t,s){return t.length=s}},6837:function(t){var s=TypeError,i=9007199254740991;t.exports=function(t){if(t>i)throw s("Maximum allowed index exceeded");return t}}}]);
//# sourceMappingURL=723.940a6301.js.map