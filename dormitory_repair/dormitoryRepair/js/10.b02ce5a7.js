"use strict";(self["webpackChunkdormitory_repair"]=self["webpackChunkdormitory_repair"]||[]).push([[10],{4114:function(t,e,o){var r=o(6518),a=o(8981),s=o(6198),i=o(4527),n=o(6837),c=o(9039),l=c(function(){return 4294967297!==[].push.call({length:4294967296},1)}),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},u=l||!d();r({target:"Array",proto:!0,arity:1,forced:u},{push:function(t){var e=a(this),o=s(e),r=arguments.length;n(o+r);for(var c=0;c<r;c++)e[o]=arguments[c],o++;return i(e,o),o}})},4376:function(t,e,o){var r=o(2195);t.exports=Array.isArray||function(t){return"Array"===r(t)}},4527:function(t,e,o){var r=o(3724),a=o(4376),s=TypeError,i=Object.getOwnPropertyDescriptor,n=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=n?function(t,e){if(a(t)&&!i(t,"length").writable)throw new s("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},5010:function(t,e,o){o.r(e),o.d(e,{default:function(){return l}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[t._m(0),e("div",{staticClass:"login-card"},[t._m(1),e("div",{staticClass:"card-body"},[e("el-form",{nativeOn:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("el-form-item",[e("el-input",{attrs:{placeholder:"请输入手机号","prefix-icon":"el-icon-user",size:"large"},model:{value:t.account,callback:function(e){t.account=e},expression:"account"}})],1),e("el-form-item",[e("el-input",{attrs:{placeholder:"请输入密码","show-password":"","prefix-icon":"el-icon-lock",size:"large"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),e("el-form-item",[e("el-button",{staticClass:"login-button",attrs:{type:"primary","native-type":"submit"}},[t._v(" 登 录 ")])],1)],1),e("div",{staticClass:"footer-links"},[e("div",{staticClass:"link-group"},[e("el-link",{staticClass:"forget-link",attrs:{type:"info"},on:{click:t.showForgetPassword}},[t._v(" 忘记密码? ")]),e("el-link",{staticClass:"student-link",attrs:{type:"primary"},on:{click:t.goToStudentPage}},[e("i",{staticClass:"el-icon-user"}),t._v(" 我是学生，无需登录 ")])],1)])],1)]),t._m(2)])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"background-layer"},[e("div",{staticClass:"background-overlay"}),e("div",{staticClass:"decoration-circle circle-1"}),e("div",{staticClass:"decoration-circle circle-2"}),e("div",{staticClass:"decoration-circle circle-3"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"card-header"},[e("div",{staticClass:"logo-container"},[e("div",{staticClass:"logo-circle"},[e("i",{staticClass:"el-icon-s-custom logo-icon"})])]),e("h1",{staticClass:"title"},[t._v("学生公寓报修系统")]),e("p",{staticClass:"subtitle"},[t._v("管理员登录入口")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer-info"},[e("p",[t._v("赣南师范大学鸿源数字思政创新研究中心")]),e("p",[t._v("© 2025 学生公寓报修系统")])])}],s=(o(4114),{data(){return{account:"",password:""}},beforeRouteEnter(t,e,o){o(t=>{t.checkAuthAndRedirect()})},mounted(){console.log("登录组件挂载")},methods:{saveTokenToCookie(t,e=10){const o=encodeURIComponent(t),r=new Date;r.setTime(r.getTime()+24*e*60*60*1e3);const a=`; expires=${r.toUTCString()}`;window.location.protocol;document.cookie=`dormitory_token=${o}${a}; path=/;`},checkAuthAndRedirect(){console.log(localStorage),localStorage.getItem("dormitory_token")&&localStorage.getItem("dormitory_work_area")&&localStorage.getItem("dormitory_name")&&"0"===localStorage.getItem("dormitory_duty")?this.$router.push({path:"/manage"}):localStorage.getItem("dormitory_token")&&localStorage.getItem("dormitory_work_area")&&localStorage.getItem("dormitory_name")&&"1"===localStorage.getItem("dormitory_duty")&&this.$router.push({path:"/worker"})},login(){this.$axios.post("/login",{phone:this.account,password:this.password}).then(t=>{if(200==t.data.code){this.$message.success("登录成功！"),console.log(t.data),localStorage.setItem("dormitory_token",t.data.data[0]),localStorage.setItem("dormitory_work_area",t.data.data[1]),localStorage.setItem("dormitory_name",t.data.data[2]),localStorage.setItem("dormitory_duty",t.data.data[3]),localStorage.setItem("dormitory_account",t.data.data[4]),localStorage.setItem("dormitory_workerId",t.data.data[5]),this.saveTokenToCookie(t.data.data[0]);const e=localStorage.getItem("dormitory_duty");console.log(e),"0"===e?(console.log(1),this.$router.push({path:"/manage"})):"1"!==e&&"2"!==e&&"3"!==e||(console.log(2),this.$router.push({path:"/worker"}))}else this.$message.error("用户名或密码错误")}).catch(()=>{this.$message.error("账号或密码错误！")})},showForgetPassword(){this.$alert("请联系管理员重置密码","忘记密码",{confirmButtonText:"确定",customClass:"forget-password-alert"})},goToStudentPage(){this.$router.push("/stu")}}}),i=s,n=o(1656),c=(0,n.A)(i,r,a,!1,null,"b0d2d2ca",null),l=c.exports},6837:function(t){var e=TypeError,o=9007199254740991;t.exports=function(t){if(t>o)throw e("Maximum allowed index exceeded");return t}}}]);
//# sourceMappingURL=10.b02ce5a7.js.map